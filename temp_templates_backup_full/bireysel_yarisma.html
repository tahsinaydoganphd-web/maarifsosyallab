<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bireysel Yarışma</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style> 
        body { font-family: 'Inter', sans-serif; background-color: #f3f4f6; } 
        /* Tıklanabilir cümle stili */
        .sentence {
            cursor: pointer;
            padding: 4px;
            margin: 2px 0;
            border-radius: 6px;
            transition: all 0.2s ease-in-out;
            border: 2px solid transparent;
        }
        .sentence:hover {
            background-color: #f0f9ff; /* light-blue-50 */
            border-color: #38bdf8; /* light-blue-400 */
        }
        /* Tıklanmış/Kullanılmış cümle */
        .sentence.clicked {
            background-color: #fef9c3; /* yellow-100 */
            border-color: #facc15; /* yellow-400 */
            cursor: not-allowed;
        }
        /* Doğru bulunan cümle */
        .sentence.correct-beceri {
            background-color: #cffafe; /* cyan-100 */
            border-color: #06b6d4; /* cyan-500 */
            cursor: not-allowed;
            font-weight: 600;
        }
        .sentence.correct-deger {
            background-color: #dcfce7; /* green-100 */
            border-color: #22c55e; /* green-500 */
            cursor: not-allowed;
            font-weight: 600;
        }
        /* Yanlış tıklanan ve hakkı düşüren cümle */
        .sentence.wrong {
            background-color: #fee2e2; /* red-100 */
            border-color: #ef4444; /* red-500 */
            cursor: not-allowed;
            opacity: 0.7;
        }
        
        /* Aktif buton stili */
        .control-btn.active {
            transform: scale(1.05);
            box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.8), 0 0 0 6px #3b82f6;
        }
        .control-btn[disabled] {
            opacity: 0.5;
            cursor: not-allowed;
        }
        .timer-bar {
            height: 6px;
            background-color: #3b82f6;
            border-radius: 3px;
            transition: width 1s linear;
        }
    </style>
</head>
<body class="flex h-screen">
    
    <!-- Sol Dikey Menü -->
    <aside class="w-72 bg-white text-gray-800 shadow-lg flex flex-col fixed h-full">
    <div class="px-6 py-4 border-b border-gray-200">

        <h1 class="text-2xl font-extrabold text-blue-600 text-center tracking-wide mb-4">
            Maarif SosyalLab
        </h1>

        <div class="mb-4">
                <div class="w-full p-2 flex items-center justify-center overflow-hidden">
                    <img src="/videolar/maarif.png"  
                         alt="Maarif Logo" 
                         class="w-auto h-auto max-w-full max-h-24 object-contain rounded-lg">
                </div>
            </div>

        <div class="flex items-center">
                <div id="user-avatar-initial" class="w-10 h-10 rounded-full bg-cyan-500 flex items-center justify-center text-white font-bold text-lg">K</div>
                <div class="ml-3">
                    <span id="user-name-placeholder" class="block text-sm font-bold text-gray-800">Kullanıcı</span>
                    <!-- Dropdown kaldırıldı -->
                </div>
            </div>
        </div>
        <nav class="flex-1 overflow-y-auto p-2 space-y-1 no-bounce">
            
            <a href="/metin-analiz" class="flex items-center mx-2 p-2 rounded-lg text-white font-semibold bg-blue-500 hover:bg-blue-600 transition-all">
                <i class="fa-solid fa-file-pen mr-3 w-6 text-center"></i>
                <span>Metin Analiz</span>
            </a>
            <a href="/soru-uretim" class="flex items-center mx-2 p-2 rounded-lg text-white font-semibold bg-green-500 hover:bg-green-600 transition-all">
                <i class="fa-solid fa-circle-question mr-3 w-6 text-center"></i>
                <span>Soru Üretim</span>
            </a>
            <a href="/haritada-bul" class="flex items-center mx-2 p-2 rounded-lg text-white font-semibold bg-orange-500 hover:bg-orange-600 transition-all">
                <i class="fa-solid fa-map-location-dot mr-3 w-6 text-center"></i>
                <span>Haritada Bul</span>
            </a>
            <a href="/podcast_paneli" class="flex items-center mx-2 p-2 rounded-lg text-white font-semibold bg-red-500 hover:bg-red-600 transition-all">
                <i class="fa-solid fa-microphone-lines mr-3 w-6 text-center"></i>
                <span>Podcast Yap</span>
            </a>
            <a href="/seyret-bul-liste" class="flex items-center mx-2 p-2 rounded-lg text-white font-semibold bg-indigo-500 hover:bg-indigo-600 transition-all">
                <i class="fa-solid fa-magnifying-glass-plus mr-3 w-6 text-center"></i>
                <span>Seyret Bul</span>
            </a>
            <a href="/yarisma-secim" class="flex items-center mx-2 p-2 rounded-lg text-white font-semibold bg-teal-600 ring-2 ring-teal-300 transition-all">
                <i class="fa-solid fa-trophy mr-3 w-6 text-center"></i>
                <span>Beceri/Değer Avcısı</span>
            </a>
            <a href="/video-istegi" class="flex items-center mx-2 p-2 rounded-lg text-white font-semibold bg-pink-500 hover:bg-pink-600 transition-all">
                <i class="fa-solid fa-video mr-3 w-6 text-center"></i>
                <span>Video İsteği</span>
            </a>
            
        </nav>
        <div class="p-4 border-t border-gray-200">
            <a href="/dashboard" class="flex items-center mx-2 p-2 rounded-lg text-gray-600 font-semibold bg-gray-100 hover:bg-gray-200 transition-all">
                <i class="fa-solid fa-arrow-left mr-3 w-6 text-center"></i>
                <span>Panele Geri Dön</span>
            </a>
        </div>
    </aside>

    <!-- Ana İçerik Alanı -->
    <main class="ml-72 flex-1 p-6 md:p-8 overflow-y-auto relative">
        <div id="game-container">
            <h2 class="text-3xl font-bold text-gray-800 mb-4">Beceri/Değer Avcısı (Bireysel)</h2>
            <!-- Skor ve Durum Alanı -->
            <div class="flex flex-wrap justify-between items-center bg-white p-4 rounded-lg shadow mt-4 gap-4">
                <div>
                    <span class="text-sm text-gray-500">Mevcut Soru</span>
                    <p id="soru-sayisi-text" class="text-2xl font-bold text-gray-800">Soru 1 / 10</p>
                </div>
                <div>
                    <span class="text-sm text-gray-500">Kalan Hak (Bu Soru İçin)</span>
                    <p id="kalan-hak-text" class="text-2xl font-bold text-red-500">3</p>
                </div>
                <div class="flex-1 min-w-[150px]">
                    <span class="text-sm text-gray-500">Kalan Süre (60sn)</span>
                    <div class="w-full bg-gray-200 rounded-full h-[6px] mt-2">
                        <div id="timer-bar" class="timer-bar" style="width: 100%;"></div>
                    </div>
                </div>
                <div id="rozetler-container" class="flex space-x-2">
                    <!-- Rozetler JS ile eklenecek -->
                </div>
            </div>
            
            <!-- Mesaj Alanı (Tebrikler, Elendiniz vb.) -->
            <div id="game-message" class="mt-4 text-center"></div>

            <!-- Oyun Alanı -->
            <div class="mt-6 max-w-4xl mx-auto"> <div>
                    <h3 class="text-lg font-semibold text-gray-700 mb-3 text-center">1. Bulunacak Tipi Seçin:</h3>
                    <div class="flex flex-col md:flex-row md:space-x-4 space-y-4 md:space-y-0 justify-center">
                        <button id="btn-beceri" data-type="beceri" class="control-btn w-full md:w-1/2 p-3 rounded-lg shadow-md font-bold text-white bg-blue-500 hover:bg-blue-600 transition-all">
                            </button>
                        <button id="btn-deger" data-type="deger" class="control-btn w-full md:w-1/2 p-3 rounded-lg shadow-md font-bold text-white bg-green-500 hover:bg-green-600 transition-all">
                            </button>
                    </div>
                </div>
                
                <div class="mt-8"> <h3 class="text-lg font-semibold text-gray-700 mb-2 text-center">2. Metinden Cümleyi Tıklayın:</h3>
                    <div id="metin-container" class="bg-white p-6 rounded-lg shadow min-h-[200px] text-lg leading-relaxed">
                        </div>
                </div>

            </div>
            
            <!-- Overlay'ler (Yükleme, Elenme, Yasak) -->
            <div id="overlay-container" class="hidden absolute inset-0 bg-white/80 flex-col items-center justify-center rounded-lg p-8 text-center z-10">
                <!-- İçerik JS ile doldurulacak -->
            </div>
        </div>
    </main>
    
    <script>
        // ########## YENİ OYUN MANTIĞI (V6 - GEMINI) ##########
        
        // --- Global Değişkenler ---
        let studentNo = localStorage.getItem('loggedInUserNo');
        let userSoyad = localStorage.getItem('loggedInUserName') || 'Kullanıcı';
        
        let kalanHak = 3;
        let soruSayisi = 0;
        let rozetler = [];
        let toplamSure = 0;
        
        let timerInterval = null;
        let saniyeBasinaDusenWidth = 100 / 60;
        let mevcutSaniye = 60;
        
        let aktifButonTipi = null; // 'beceri' veya 'deger'
        let cevapAnahtari = {
            beceri_cumlesi: "",
            deger_cumlesi: ""
        };
        let bulundu = {
            beceri: false,
            deger: false
        };
        let tiklananCumleler = []; // Aynı cümleye tekrar tıklamayı engelle

        // --- DOM Elementleri ---
        const gameContainer = document.getElementById('game-container');
        const kalanHakText = document.getElementById('kalan-hak-text');
        const soruSayisiText = document.getElementById('soru-sayisi-text');
        const rozetlerContainer = document.getElementById('rozetler-container');
        const gameMessage = document.getElementById('game-message');
        const btnBeceri = document.getElementById('btn-beceri');
        const btnDeger = document.getElementById('btn-deger');
        const metinContainer = document.getElementById('metin-container');
        const timerBar = document.getElementById('timer-bar');
        const overlayContainer = document.getElementById('overlay-container');

        // --- Paneldeki Kullanıcı Adını Yükleme ---
    document.addEventListener('DOMContentLoaded', () => {
        // --- GÜNCELLEME: Değişken adı "userSoyad" -> "userFullName" oldu ---
        // 'userSoyad' değişkeni zaten script'in en başında tanımlı (localStorage'dan alınıyor)
        // Sadece o değişkenin adını en başta değiştirmek yerine, burada yeni bir değişken oluşturuyoruz.
        const userFullName = localStorage.getItem('loggedInUserName'); 
        const namePlaceholder = document.getElementById('user-name-placeholder');
        const avatarInitial = document.getElementById('user-avatar-initial');

        if (namePlaceholder && userFullName) {
            namePlaceholder.textContent = userFullName; // Değişti
        }
        if (avatarInitial && userFullName) {
            // İlk harfi al (Adın ilk harfi)
            avatarInitial.textContent = userFullName[0] ? userFullName[0].toUpperCase() : 'K'; // Değişti
        }
        // --- GÜNCELLEME BİTTİ ---

        if (!studentNo) {
                gameContainer.innerHTML = '<h2 class="text-2xl font-bold text-red-600">Hata: Giriş yapılmamış!</h2><p>Lütfen önce ana sayfadan giriş yapın.</p>';
                return;
            }
            
            // Oyunu Başlat
            oyunuBaslat();
        });

        // --- Oyun Fonksiyonları ---

        async function oyunuBaslat() {
            // 1. Öğrenci durumunu kontrol et (Yasaklı mı?)
            try {
                const response = await fetch('/api/bireysel/basla', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ student_no: studentNo })
                });
                const result = await response.json();
                
                if (!result.success && result.giris_yasakli) {
                    // YASAKLI EKRANI
                    showOverlay('yasak', result.mesaj);
                    return;
                }
                
                // 2. Durumu ve skoru güncelle
                soruSayisi = result.durum.dogru_soru_sayisi;
                rozetler = []; // Her oyun yeni rozetlerle başlar
                toplamSure = result.durum.toplam_sure_saniye;
                guncelleSkorboard();

                // 3. İlk soruyu yükle
                yeniSoruGetir();
                
            } catch (e) {
                showGameMessage('Hata: Sunucuyla bağlantı kurulamadı.', 'red');
            }
        }

        async function yeniSoruGetir() {
            showOverlay('loading');
            stopTimer();
            
            try {
                const response = await fetch('/api/bireysel/yeni_soru', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ student_no: studentNo })
                });
                const result = await response.json();
                
                if (result.success) {
                    const data = result.data;
                    
                    cevapAnahtari.beceri_cumlesi = data.beceri_cumlesi.trim();
                    cevapAnahtari.deger_cumlesi = data.deger_cumlesi.trim();
                    btnBeceri.textContent = data.beceri_adi + " Becerisi";
                    btnDeger.textContent = data.deger_adi + " Değeri";
                    
                    metinContainer.innerHTML = '';
                    const sentences = data.metin.match(/[^.!?]+[.!?]+/g) || [data.metin];
                    
                    sentences.forEach((sentenceText, index) => {
                        const span = document.createElement('span');
                        span.textContent = sentenceText.trim() + ' ';
                        span.className = 'sentence';
                        span.dataset.id = `s-${index}`;
                        span.onclick = () => cumleTikla(span);
                        metinContainer.appendChild(span);
                    });
                    
                    resetSoruDurumu();
                } else {
                    // ########## GÜNCELLEME: API Hata Düzeltmesi ##########
                    // Metin gelmeme hatası (API Key eksikse)
                    showOverlay('api_error', result.metin || 'Hata: Yeni soru yüklenemedi.');
                }
            } catch (e) {
                showOverlay('api_error', 'Sunucuyla iletişim kurulamadı. Lütfen API anahtarınızı kontrol edin.');
            } finally {
                // Not: Başarılı olursa 'loading' overlay'i resetSoruDurumu() kaldırır
                // Başarısız olursa 'api_error' overlay'i kalır.
            }
        }
        
        function resetSoruDurumu() {
            kalanHak = 3;
            aktifButonTipi = null;
            bulundu = { beceri: false, deger: false };
            tiklananCumleler = [];
            
            kalanHakText.textContent = kalanHak;
            kalanHakText.className = "text-2xl font-bold text-red-500";
            
            btnBeceri.disabled = false;
            btnDeger.disabled = false;
            btnBeceri.classList.remove('active', 'opacity-50');
            btnDeger.classList.remove('active', 'opacity-50');
            
            showGameMessage('Lütfen önce bir buton seçin (Beceri veya Değer), sonra metinden ilgili cümleyi bulun.', 'blue');
            
            showOverlay('none'); // Yükleme ekranını gizle
            startTimer();
        }

        // Kontrol Butonları (Beceri / Değer)
        btnBeceri.onclick = () => setAktifButon('beceri');
        btnDeger.onclick = () => setAktifButon('deger');

        function setAktifButon(tip) {
            if ( (tip === 'beceri' && bulundu.beceri) || (tip === 'deger' && bulundu.deger) ) {
                return; // Zaten bulunduysa bu butonu seçme
            }

            // --- YENİ EKLENDİ (İsteğiniz) ---
            // Yeni bir buton seçildiğinde, önceki denemedeki
            // 'wrong' (kırmızı) işaretlerini temizle.
            document.querySelectorAll('.sentence.wrong').forEach(span => {
                span.classList.remove('wrong');
            });
            // --- BİTTİ ---

            aktifButonTipi = tip;
            
            if (tip === 'beceri') {
                btnBeceri.classList.add('active');
                btnDeger.classList.remove('active');
            } else {
                btnDeger.classList.add('active');
                btnBeceri.classList.remove('active');
            }
            showGameMessage(`"${tip === 'beceri' ? btnBeceri.textContent : btnDeger.textContent}" cümlesini metinde bulun.`, 'blue');
        }

        // Cümleye Tıklama Mantığı
        function cumleTikla(spanElement) {
            const cumleMetni = spanElement.textContent.trim();
            
            // 1. Kontroller
            if (kalanHak <= 0 || (bulundu.beceri && bulundu.deger)) return;
            if (!aktifButonTipi) {
                showGameMessage('Lütfen önce "Beceri" veya "Değer" butonlarından birini seçin!', 'red');
                return;
            }
            
            // 'tiklananCumleler.includes' KONTROLÜ ARTIK YOK

            // 2. Tıklanana Ekle
            // 'tiklananCumleler.push' ARTIK YOK

            let dogruMu = false;
            // ... (kodun geri kalanı)

            // 3. Cevap Kontrolü
            if (aktifButonTipi === 'beceri' && cumleMetni === cevapAnahtari.beceri_cumlesi) {
                bulundu.beceri = true;
                dogruMu = true;
                spanElement.className = 'sentence correct-beceri'; // Mavi
                btnBeceri.disabled = true;
                btnBeceri.classList.add('opacity-50');
                btnBeceri.classList.remove('active');
                showGameMessage('Beceri cümlesi DOĞRU! Şimdi Değer cümlesini bulun.', 'green');
                aktifButonTipi = null; 
            } 
            else if (aktifButonTipi === 'deger' && cumleMetni === cevapAnahtari.deger_cumlesi) {
                bulundu.deger = true;
                dogruMu = true;
                spanElement.className = 'sentence correct-deger'; // Yeşil
                btnDeger.disabled = true;
                btnDeger.classList.add('opacity-50');
                btnDeger.classList.remove('active');
                showGameMessage('Değer cümlesi DOĞRU! Şimdi Beceri cümlesini bulun.', 'green');
                aktifButonTipi = null; 
            }
            
            // 4. Yanlış Cevap (Hakkı SADECE BURADA DÜŞÜR)
            if (!dogruMu) {
                kalanHak--; // <-- YERİ DEĞİŞTİ
                kalanHakText.textContent = kalanHak; // <-- YERİ DEĞİŞTİ
                spanElement.className = 'sentence wrong';
                showGameMessage(`YANLIŞ! Kalan hak: ${kalanHak}`, 'red');
            }

            // 5. Durum Kontrolü (Kazandı mı? Elendi mi?)
            checkGameStatus();
        }
        
        async function checkGameStatus() {
            // KAZANDI (İkisini de buldu)
            if (bulundu.beceri && bulundu.deger) {
                stopTimer();
                let harcananSure = 60 - mevcutSaniye;
                
                showGameMessage('TEBRİKLER! Her ikisini de buldunuz. Yeni soru yükleniyor...', 'green', false);
                
                // Skoru sunucuya kaydet
                const response = await fetch('/api/bireysel/kaydet_dogru', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        student_no: studentNo,
                        soru_suresi_saniye: harcananSure
                    })
                });
                const result = await response.json();

                // Rozet kazandıysa özel mesajı göster
                if(result.rozet_sonucu && result.rozet_sonucu.yeni_rozet) {
                    showGameMessage(result.rozet_sonucu.mesaj, 'green', false);
                }

                // Puanı ve rozetleri yenile
                soruSayisi = result.yeni_dogru_sayisi;
                rozetler = result.rozet_sonucu.yeni_durum.rozetler || rozetler;
                guncelleSkorboard();
                
                // 10 soruyu da bitirdi mi?
                if (soruSayisi >= 10) {
                    // Altın rozet yasağı zaten sunucuda (kaydet_dogru) ayarlandı.
                    setTimeout(() => {
                        showOverlay('final', result.rozet_sonucu.mesaj);
                    }, 3000);
                } else {
                    setTimeout(yeniSoruGetir, 3000); // 3 saniye sonra yeni soru
                }
            }
            // ELENDİ (Hak bitti)
            else if (kalanHak <= 0) {
                stopTimer();
                let harcananSure = 60 - mevcutSaniye;
                kalanHakText.className = "text-2xl font-bold text-gray-400";
                
                // Sunucuya elenme süresini kaydet
                await fetch('/api/bireysel/kaydet_elenme', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        student_no: studentNo,
                        harcanan_sure_saniye: harcananSure
                    })
                });
                
                // 10 saniyelik teselli mesajı
                showOverlay('elendin', 'Hakkınız bitti, bu turda elendiniz. 10 saniye sonra yarışma seçim ekranına yönlendirileceksiniz...');
                
                setTimeout(() => {
                    window.location.href = '/yarisma-secim';
                }, 10000); // 10 saniye sonra yönlendir
            }
        }
        
        function guncelleSkorboard() {
            soruSayisiText.textContent = `Soru ${soruSayisi + 1} / 10`;
            
            rozetlerContainer.innerHTML = ''; // Temizle
            if (rozetler.includes('bronz')) {
                rozetlerContainer.innerHTML += '<i class="fa-solid fa-medal text-3xl text-yellow-600" title="Bronz Rozet"></i>';
            }
            if (rozetler.includes('gumus')) {
                rozetlerContainer.innerHTML += '<i class="fa-solid fa-medal text-3xl text-gray-400" title="Gümüş Rozet"></i>';
            }
            if (rozetler.includes('altin')) {
                rozetlerContainer.innerHTML += '<i class="fa-solid fa-medal text-3xl text-yellow-400" title="Altın Rozet"></i>';
            }
        }

        // --- Zamanlayıcı (Timer) Fonksiyonları ---
        function startTimer() {
            mevcutSaniye = 60;
            timerBar.style.width = '100%';
            timerBar.classList.remove('bg-red-500');
            timerBar.classList.add('bg-blue-500');
            
            stopTimer(); // Önceki timer'ı durdur
            
            timerInterval = setInterval(() => {
                mevcutSaniye--;
                let widthPercent = (mevcutSaniye / 60) * 100;
                timerBar.style.width = `${widthPercent}%`;
                
                if (mevcutSaniye <= 10) {
                    timerBar.classList.remove('bg-blue-500');
                    timerBar.classList.add('bg-red-500');
                }
                
                if (mevcutSaniye <= 0) {
                    stopTimer();
                    sureDoldu();
                }
            }, 1000);
        }
        
        function stopTimer() {
            clearInterval(timerInterval);
        }

        async function sureDoldu() {
            let harcananSure = 60;
            
            // Sunucuya elenme süresini kaydet
            await fetch('/api/bireysel/kaydet_elenme', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ 
                    student_no: studentNo,
                    harcanan_sure_saniye: harcananSure
                })
            });
            
            // 10 saniyelik teselli mesajı
            showOverlay('elendin', 'Süreniz doldu, bu turda elendiniz. 10 saniye sonra yarışma seçim ekranına yönlendirileceksiniz...');
            
            setTimeout(() => {
                window.location.href = '/yarisma-secim';
            }, 10000); // 10 saniye sonra yönlendir
        }
        
        // --- Yardımcı Fonksiyonlar ---
        
        function showGameMessage(message, type = 'blue', autoClear = true) {
            let colorClasses = 'bg-blue-100 text-blue-800'; // default
            if (type === 'red') colorClasses = 'bg-red-100 text-red-800';
            if (type === 'green') colorClasses = 'bg-green-100 text-green-800';
            if (type === 'yellow') colorClasses = 'bg-yellow-100 text-yellow-800';
            
            gameMessage.innerHTML = `<div class="p-3 rounded-lg ${colorClasses} font-semibold">${message}</div>`;
            
            if (autoClear) {
                setTimeout(() => {
                    if (gameMessage.innerHTML.includes(message)) {
                        gameMessage.innerHTML = '';
                    }
                }, 3000);
            }
        }
        
        function showOverlay(type, message = '') {
            if (type === 'none') {
                overlayContainer.style.display = 'none';
                return;
            }
            
            let content = '';
            if (type === 'loading') {
                content = `
                    <div class="w-16 h-16 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"></div>
                    <p class="mt-4 text-lg font-semibold text-gray-700">Yeni soru hazırlanıyor...</p>
                `;
            } else if (type === 'yasak') {
                content = `
                    <i class="fa-solid fa-gavel text-6xl text-red-500 mb-4"></i>
                    <h2 class="text-3xl font-bold text-red-700">Yarışma Yasağı</h2>
                    <p class="text-gray-700 mt-2 text-lg">${message}</p>
                    <a href="/dashboard" class="mt-6 bg-blue-500 text-white font-semibold py-2 px-4 rounded-lg hover:bg-blue-600">Panele Dön</a>
                `;
            } else if (type === 'elendin') {
                content = `
                    <i class="fa-solid fa-face-sad-tear text-6xl text-blue-500 mb-4"></i>
                    <h2 class="text-3xl font-bold text-blue-700">Oyun Bitti</h2>
                    <p class="text-gray-700 mt-2 text-lg">${message}</p>
                `;
            } else if (type === 'final') {
                content = `
                    <i class="fa-solid fa-trophy text-6xl text-yellow-500 mb-4"></i>
                    <h2 class="text-3xl font-bold text-yellow-700">Yarışma Bitti!</h2>
                    <p class="text-gray-700 mt-2 text-lg">${message}</p>
                `;
            } else if (type === 'api_error') {
                 content = `
                    <i class="fa-solid fa-circle-exclamation text-6xl text-red-500 mb-4"></i>
                    <h2 class="text-3xl font-bold text-red-700">API Hatası</h2>
                    <p class="text-gray-700 mt-2 text-lg">${message}</p>
                    <p class="text-gray-500 mt-2 text-sm">Lütfen 'sosyallab.py' dosyasındaki API anahtarınızı kontrol edin.</p>
                    <a href="/dashboard" class="mt-6 bg-blue-500 text-white font-semibold py-2 px-4 rounded-lg hover:bg-blue-600">Panele Dön</a>
                `;
            }
            
            overlayContainer.innerHTML = content;
            overlayContainer.style.display = 'flex';
        }
        
    </script>
</body>
</html>